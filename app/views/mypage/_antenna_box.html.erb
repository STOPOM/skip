<%
  # TODO cacheする仕組みにしたい
  system_notices = Notice.systems(current_user)
-%>
<div class="box_space antenna" style="position: relative;">
  <div style="position: absolute; top: 4px; right: 4px;"><%= icon_tag 'help', :title => _('What is Subscription') + "|" + _('Subscription Description') %></div>
  <div class="box_space_title">
    <%= icon_tag 'transmit' %><%= link_to(_("Subscriptions"), :action => 'entries_by_antenna') %>
  </div>
  <div class="box_space_body">
    <ul id="antennas_list">
      <% system_notices.each do |notice| -%>
        <% count_as_s = notice[:count] > 0 ? "(#{h notice[:count]})" : '' -%>
        <li><%= link_to(h(notice[:name]), :action => 'entries_by_antenna', :target_type => notice[:type]) + count_as_s %></li>
      <% end -%>
      <% current_user.notices.each do |notice| -%>
        <% count_as_s = "(#{notice.unread_count(current_user).to_s})" -%>
        <li><%= link_to(h(notice.target.name), :action => 'entries_by_antenna', :target_type => notice.target.class.name.downcase, :target_id => notice.target.id) + count_as_s %></li>
      <% end -%>
    </ul>
  </div>
  <div class="box_space_bottom"><%= link_to _('[Manage subscriptions]'), :action => 'manage', :menu => 'manage_antenna' %></div>
</div>
